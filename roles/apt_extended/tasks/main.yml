# Install the latest version of Go.
# https://github.com/golang/go/wiki/Ubuntu
- name: Register Go apt-repository
  apt_repository:
    repo: ppa:gophers/archive
    update_cache: yes
  become: yes
- name: Install Go 1.9
  apt:
    name: golang-1.9-go
    force: yes
    update_cache: yes
    cache_valid_time: 86400
  become: yes

# Install the latest version of docker on ubuntu.
# https://docs.docker.com/engine/installation/linux/ubuntu/
- name: Install Docker GPG key
  become: yes
  apt_key:
    url: "https://download.docker.com/linux/ubuntu/gpg"
    id: 0EBFCD88
- name: Register docker apt-repository
  become: yes
  apt_repository:
    repo: deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ ansible_lsb.codename }} stable
    update_cache: yes
- name: Install docker-ce
  become: yes
  apt:
    name: docker-ce
    force: yes
    update_cache: yes
    cache_valid_time: 3600
- name: Add {{ user }} to docker group
  become: yes
  user:
    name: "{{ user }}"
    shell: /bin/zsh
    append: yes
    groups: docker

# Install the latest Node.js
# https://nodejs.org/en/download/package-manager/#debian-and-ubuntu-based-linux-distributions
- name: Install NodeSource GPG key
  become: yes
  apt_key:
    url: "https://deb.nodesource.com/gpgkey/nodesource.gpg.key"
    id: 68576280
- name: Register NodeSource apt-repository
  become: yes
  apt_repository:
    repo: deb https://deb.nodesource.com/node_9.x {{ansible_lsb.codename}} main
    update_cache: yes
- name: Register NodeSource deb-src apt-repository
  become: yes
  apt_repository:
    repo: deb-src https://deb.nodesource.com/node_9.x {{ansible_lsb.codename}} main
    update_cache: yes
- name: Install the latest Node.js
  become: yes
  apt:
    name: nodejs
    force: yes
    update_cache: yes
    cache_valid_time: 86400
